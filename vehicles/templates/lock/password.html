{% extends "base.html" %}

{% block content %}
    <form method="post" id="add-password-form">
        <label for="new_password">新密码：</label>
        <input id="new_password" type="password" name="new_password" required autocomplete="new-password">
        <input type="hidden" name="action" value="add_password">
        <button type="submit">设置密码</button>
    </form>

    <form method="post">
        <label for="get_password">获取密码</label>
        <input type="hidden" name="action" value="get_password">
        <button type="submit">获取密码</button>
    </form>

    <p>{{ request.args.get('password') }}</p>

    <a href="{{ url_for('home.index') }}">返回首页</a>

    <script>
    // Focus the new-password input only when the add-password form was just submitted.
    (function(){
        const input = document.getElementById('new_password');
        if (!input) return;
        try {
            const params = new URLSearchParams(window.location.search);
            if (params.get('added') === '1') {
                input.focus();
                // remove the param from the URL to avoid focusing on subsequent reloads
                params.delete('added');
                const newUrl = window.location.pathname + (params.toString() ? '?' + params.toString() : '');
                window.history.replaceState(null, '', newUrl);
            }
        } catch (e) {
            // no-op
        }
    })();
    </script>

{% endblock %}